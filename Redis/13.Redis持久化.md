> 为了让`redis`再断电后仍能保存数据

# RDB存储

> 在指定的时间间隔中将内存中的数据集快照写入磁盘中。恢复时将快照直接读到内存中
>
> 整个过程中主进程不进行IO操作，比AOF高效
>
> 最后一次持久化的数据可能会丢。所以处理数据量多但不敏感的数据

> `rdb`保存的文件就是`dump.rdb`.在配置中的快照配置中配置

### 手动保存到文件

```
save
```

> 文件保存成功后，`redis`进程关闭再打开数据还在

#### dump文件生成机制

- save的规则满足(如手动调用save/插入值)
- 执行`flushall`
- 退出`redis`

> 启动时会到指定位置自动恢复
>



### 优点

- 通过子线程fork，性能高
- 适合大规模数据恢复
- 适合完整性不高的数据

### 缺点

- `redis`意外宕机时最后一次数据会丢失(生成环境会定时备份)
- 文件占用比较大



# AOF存储(append only file)

> 通过记录操作记录来备份文件。只记录写操作。类似于数据库日志
>
> 恢复时需要一条条的写，所以数据量大会很久
>
> 默认不开启

> 当AOF文件出错时，`redis`将无法启动，需要通过修复工具修复